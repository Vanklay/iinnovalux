---
import Button from '../ui/Button.astro';
---

<section class="relative h-screen min-h-[600px] flex items-end bg-dark-primary overflow-hidden">
  <!-- Background image with parallax -->
  <div class="absolute inset-0 overflow-hidden">
    <div id="hero-parallax" class="absolute inset-0 will-change-transform" style="transform: translateY(0); height: 120%;">
      <img
        src="/images/hero-image.webp"
        srcset="/images/hero-image-480.webp 480w,
                /images/hero-image-800.webp 800w,
                /images/hero-image.webp 1415w"
        sizes="100vw"
        alt="Services de bricolage et maintenance au Luxembourg"
        width="1415"
        height="1320"
        fetchpriority="high"
        loading="eager"
        decoding="async"
        elementtiming="hero-image"
        class="w-full h-full object-cover"
      />
    </div>
    <!-- Elevated gradient overlay - starts higher -->
    <div class="absolute inset-0 bg-gradient-to-t from-dark-primary via-dark-primary/80 via-50% to-transparent"></div>
  </div>

  <!-- Content - bottom aligned -->
  <div class="relative z-10 w-full pb-12 md:pb-20 lg:pb-28">
    <div class="container mx-auto px-5 md:px-6 lg:px-16">

      <!-- Split layout -->
      <div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6 md:gap-12 lg:gap-20 text-center md:text-left">

        <!-- Left: Main headline -->
        <div class="max-w-4xl mx-auto md:mx-0">
          <h1 class="hero-title font-display text-white leading-[0.9] tracking-[-0.02em]" elementtiming="hero-heading">
            <span class="block text-4xl sm:text-5xl md:text-5xl lg:text-6xl xl:text-7xl">Travaux, Réparation</span>
            <span class="block text-4xl sm:text-5xl md:text-5xl lg:text-6xl xl:text-7xl">& Maintenance</span>
            <span class="block text-2xl sm:text-3xl md:text-3xl lg:text-4xl xl:text-5xl italic font-light text-gold mt-2 md:mt-3">au Luxembourg</span>
          </h1>
        </div>

        <!-- Right: Tagline -->
        <div class="hero-tagline lg:max-w-sm lg:pb-4">
          <div class="flex items-center justify-center md:justify-start gap-4 md:gap-6 mb-4 md:mb-6">
            <span class="h-px w-8 md:flex-1 bg-white/20"></span>
            <span class="text-gold text-[10px] md:text-xs tracking-[0.3em] uppercase">Devis gratuit</span>
            <span class="h-px w-8 md:hidden bg-white/20"></span>
          </div>
          <p class="text-white/60 text-base md:text-lg lg:text-xl leading-relaxed">
            Votre partenaire de confiance pour tous vos travaux de maison. Qualité et professionnalisme.
          </p>
        </div>

      </div>

      <!-- Bottom bar -->
      <div class="flex flex-col sm:flex-row items-center sm:justify-between gap-6 md:gap-8 mt-10 md:mt-16 pt-6 md:pt-8 border-t border-white/10">

        <!-- CTAs -->
        <div class="hero-cta flex items-center gap-6 md:gap-8">
          <a
            href="/contact"
            class="hero-btn group relative inline-flex items-center gap-3 text-xs md:text-sm text-white tracking-wide uppercase"
          >
            <span class="relative w-12 h-12 rounded-full border border-white/30 flex items-center justify-center overflow-hidden">
              <!-- Background fill animation -->
              <span class="absolute inset-0 bg-gold scale-0 group-hover:scale-100 transition-transform duration-500 ease-out rounded-full"></span>
              <!-- Arrow icon -->
              <svg class="relative z-10 w-4 h-4 md:w-5 md:h-5 transition-all duration-300 group-hover:text-dark-primary group-hover:translate-x-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </span>
            <span class="relative overflow-hidden">
              <span class="block transition-transform duration-300 group-hover:-translate-y-full">Demander un devis</span>
              <span class="absolute top-0 left-0 block translate-y-full transition-transform duration-300 group-hover:translate-y-0 text-gold">Demander un devis</span>
            </span>
          </a>

          <a
            href="/services"
            class="group relative text-xs md:text-sm text-white/50 tracking-wide uppercase overflow-hidden"
          >
            <span class="block transition-transform duration-300 group-hover:-translate-y-full group-hover:opacity-0">Nos services</span>
            <span class="absolute top-0 left-0 block translate-y-full transition-transform duration-300 group-hover:translate-y-0 text-white">Nos services</span>
          </a>
        </div>

        <!-- Google Rating Badge -->
        <a
          href="https://share.google/fxsiZAhvFwYymryVv"
          target="_blank"
          rel="noopener noreferrer"
          class="hero-rating group flex items-center gap-2 text-white/70 hover:text-white transition-colors"
        >
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
            <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
            <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
            <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
            <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
          </svg>
          <span class="text-sm font-medium text-white">5.0</span>
          <div class="flex gap-0.5">
            {Array.from({ length: 5 }).map(() => (
              <svg class="w-3.5 h-3.5 text-gold" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
              </svg>
            ))}
          </div>
          <span class="text-xs text-white/50">(22 avis)</span>
        </a>

      </div>

    </div>
  </div>

  <!-- Seamless fade to next section -->
  <div class="absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-dark-primary to-transparent pointer-events-none"></div>
</section>

<script>
  // Trigger animations after LCP is detected (requestAnimationFrame ensures render complete)
  requestAnimationFrame(() => {
    requestAnimationFrame(() => {
      document.querySelectorAll('.hero-title, .hero-tagline, .hero-cta, .hero-rating').forEach(el => {
        el.classList.add('animate');
      });
    });
  });

  // Lightweight parallax effect (respects reduced motion)
  const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  if (!prefersReducedMotion) {
    const parallaxEl = document.getElementById('hero-parallax');
    let ticking = false;

    const updateParallax = () => {
      const scrollY = window.scrollY;
      const heroHeight = window.innerHeight;

      // Only apply parallax while hero is visible
      if (scrollY < heroHeight && parallaxEl) {
        parallaxEl.style.transform = `translateY(${scrollY * 0.35}px)`;
      }
      ticking = false;
    };

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(updateParallax);
        ticking = true;
      }
    }, { passive: true });
  }
</script>

<style>
  /* Start visible for LCP - animations triggered by JS after load */
  .hero-title,
  .hero-tagline,
  .hero-cta,
  .hero-rating {
    opacity: 1;
    transform: translateY(0);
  }

  @media (prefers-reduced-motion: no-preference) {
    .hero-title.animate,
    .hero-tagline.animate,
    .hero-cta.animate,
    .hero-rating.animate {
      animation: fadeUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    .hero-tagline.animate { animation-delay: 0.15s; }
    .hero-cta.animate { animation-delay: 0.3s; }
    .hero-rating.animate { animation-delay: 0.45s; }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  }
</style>
