---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { blogPosts } from '../../data/blog';
import CTABanner from '../../components/sections/CTABanner.astro';

// Sort by date, newest first
const sortedPosts = [...blogPosts].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

const categories = [...new Set(blogPosts.map(post => post.category))];
---

<BaseLayout
  title="Conseils et Astuces Bricolage Maison Luxembourg"
  description="Conseils pratiques pour l'entretien de votre maison au Luxembourg. Bricolage, jardinage, déménagement, prix des travaux et astuces de professionnels."
  keywords="conseils bricolage Luxembourg, astuces maison, entretien domicile, prix travaux Luxembourg, blog handyman"
  breadcrumb={[{ label: 'Accueil', href: '/' }, { label: 'Conseils' }]}
>
  <!-- Hero -->
  <section class="relative pt-32 pb-16 md:pt-40 md:pb-20 overflow-hidden">
    <div class="absolute inset-0 pointer-events-none">
      <div class="absolute top-[5%] left-[5%] w-[400px] h-[400px] bg-gold/15 rounded-full blur-[100px] animate-float-1"></div>
      <div class="absolute top-[10%] right-[10%] w-[300px] h-[300px] bg-gold/10 rounded-full blur-[80px] animate-float-2"></div>
    </div>

    <div class="relative container mx-auto px-4 lg:px-8">
      <nav class="mb-8">
        <ol class="flex items-center gap-2 text-sm">
          <li><a href="/" class="text-white/40 hover:text-white transition-colors">Accueil</a></li>
          <li class="text-white/20">/</li>
          <li class="text-white/60">Conseils</li>
        </ol>
      </nav>
      <h1 class="font-display text-4xl md:text-5xl lg:text-6xl text-white mb-4">
        Conseils & Astuces
      </h1>
      <p class="text-white/50 text-lg max-w-xl">
        Guides pratiques et conseils d'experts pour l'entretien de votre maison au Luxembourg
      </p>
    </div>
  </section>

  <!-- Category Filter -->
  <section class="py-6 border-b border-white/5">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
        <button class="category-btn active px-4 py-2 rounded-full bg-gold/20 text-white text-sm font-medium whitespace-nowrap transition-all" data-category="all">
          Tous
        </button>
        {categories.map((category) => (
          <button class="category-btn px-4 py-2 rounded-full bg-white/5 hover:bg-gold/20 text-white/60 hover:text-white text-sm font-medium whitespace-nowrap transition-all" data-category={category}>
            {category}
          </button>
        ))}
      </div>
    </div>
  </section>

  <!-- Blog Grid -->
  <section class="py-16 md:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
        {sortedPosts.map((post, index) => (
          <article
            class="blog-card group"
            data-category={post.category}
            data-reveal
            style={`animation-delay: ${index * 0.05}s`}
          >
            <a href={`/blog/${post.slug}`} class="block h-full">
              <div class="h-full bg-dark-secondary rounded-2xl border border-white/5 hover:border-gold/30 transition-all duration-300 overflow-hidden">
                <!-- Category & Date -->
                <div class="p-6 pb-0">
                  <div class="flex items-center justify-between mb-4">
                    <span class="px-3 py-1 rounded-full bg-gold/10 text-gold text-xs font-medium">
                      {post.category}
                    </span>
                    <span class="text-white/30 text-xs">
                      {new Date(post.date).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short', year: 'numeric' })}
                    </span>
                  </div>
                </div>

                <!-- Content -->
                <div class="p-6 pt-2">
                  <h2 class="font-display text-xl text-white mb-3 group-hover:text-gold transition-colors line-clamp-2">
                    {post.title}
                  </h2>
                  <p class="text-white/40 text-sm leading-relaxed line-clamp-3 mb-4">
                    {post.excerpt}
                  </p>

                  <!-- Read more -->
                  <div class="flex items-center justify-between pt-4 border-t border-white/5">
                    <span class="text-white/30 text-xs">{post.readTime} min de lecture</span>
                    <span class="flex items-center gap-2 text-gold/60 text-sm group-hover:text-gold transition-colors">
                      Lire
                      <svg class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                      </svg>
                    </span>
                  </div>
                </div>
              </div>
            </a>
          </article>
        ))}
      </div>
    </div>
  </section>

  <CTABanner
    title="Une question sur vos travaux ?"
    subtitle="Nos experts vous conseillent gratuitement"
    buttonText="Nous contacter"
    buttonHref="/contact"
  />
</BaseLayout>

<style>
  .blog-card {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeUp 0.5s ease-out forwards;
  }

  .blog-card.hidden {
    display: none;
  }

  @keyframes fadeUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes float-1 {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(15px, -10px); }
  }

  @keyframes float-2 {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(-12px, 12px); }
  }

  .animate-float-1 { animation: float-1 20s ease-in-out infinite; }
  .animate-float-2 { animation: float-2 25s ease-in-out infinite; }

  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  .category-btn.active {
    background: rgba(249, 189, 37, 0.2);
    color: white;
  }
</style>

<script>
  const categoryBtns = document.querySelectorAll('.category-btn');
  const blogCards = document.querySelectorAll('.blog-card');

  categoryBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const category = btn.getAttribute('data-category');

      // Update active state
      categoryBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Filter cards
      blogCards.forEach(card => {
        const cardCategory = card.getAttribute('data-category');
        if (category === 'all' || cardCategory === category) {
          card.classList.remove('hidden');
        } else {
          card.classList.add('hidden');
        }
      });
    });
  });
</script>
